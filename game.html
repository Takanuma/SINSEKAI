<!DOCTYPE html>
<head>
<title>勇者は魔王を倒すため旅に出る</title>
<style type="text/css">
#maxEnemy {
width: 200px;
height: 20px;
background-color:black;
position: relative;
}
#nowEnemy {
width: 200px;
height: 20px;
background:linear-gradient(#F89174, #FFC778);
text-align: right;
position: absolute;
left: 0px;
top: 0px;
}
#maxMe {
width: 200px;
height: 20px;
background-color:black;
position: relative;
}
#nowMe {
width: 200px;
height: 20px;
background:linear-gradient(green,gray);
text-align: right;
position: absolute;
left: 0px;
top: 0px;
}
#txt {
width: 300px;
}
#txt2{
  width:300px;
}
#btn1 {
display: block;
}
#btn2 {
display: none;
}
#btn3 {
display: block;
}
</style>

<script type="text/javascript">

// ★初期化
function load() {
if(!localStorage.getItem('mydata')) {
mydata = 0;
localStorage.setItem('mydata', mydata);
}
//死体数処理
mydata = localStorage.getItem('mydata');
document.getElementById("mydata_out").innerHTML ="合計" + mydata + "人が死亡";
//レベル処理
if(!localStorage.getItem('mylevel')) {
level = 1;
localStorage.setItem('mylevel', level);
}
level=localStorage.getItem('mylevel');
document.getElementById("level").innerHTML ="レベル" + level;
//HP処理
maxhpE = Math.floor(Math.random() * 100)+100+(level*5);
nowhpE = maxhpE;
maxhpMe=100+(level*10);
nowhpMe =maxhpMe;
//表示処理
N = document.getElementById("nowEnemy");
NMe = document.getElementById("nowMe");
T = document.getElementById("txt");
T2 = document.getElementById("txt2");
B1 = document.getElementById("btn1");
B2 = document.getElementById("btn2");

power=1;
MAO=0;
N.innerHTML =nowhpE + "/" + maxhpE;
NMe.innerHTML = nowhpMe + "/" + maxhpMe;

yourname.innerHTML = "ゆうしゃ";
nameE.innerHTML ="太田ジョンソン";

}

// ★ゲージ減少
function attack() {
random = Math.floor(Math.random() * 10);
random *=power;
damage=Number(level)+5+random;
nowhpE-=damage;
enemyname="太田ジョンソン";
if(MAO==1)enemyname="魔王";
nameE.innerHTML=enemyname;
if (nowhpE > 0) {
  if (random == 0) {
    str = enemyname +"に攻撃をかわされた";
  } else {
    str = enemyname +"に" + damage + "のダメージを与えた"+level;
  }
}

if(nowhpE<=0){
  nowhpE = 0;
  str = "太田ジョンソンは力尽きた";
  if(MAO==1&&nowhpE<=0)str="魔王は死に、世界に平和が訪れた。";
  B1.style.display = "none";
  B2.style.display = "block";
}
T.value = str;
N.innerHTML =nowhpE + "/" + maxhpE;
N.style.width = 200 / maxhpE * nowhpE + "px";

//ＴＥＫＩＮＯｋｏｕＫＩＧＥ
if(MAO==0){
random = Math.floor(Math.random() * 30);
nowhpMe-=random;
if (nowhpMe > 0) {
if (random == 0) {
str = "あなたは攻撃をかわした";
} else {
str = "あなたは" + random + "のダメージを与えられた";
}
} else {
nowhpMe = 0;
str = "あなたはは力尽きた";
if(nowhpE<=0){
  str="あなたは勝利した";
}
B1.style.display = "none";
B2.style.display = "block";
}
T2.value=str;
NMe.innerHTML = nowhpMe + "/" + maxhpMe;
NMe.style.width = 200 / maxhpMe * nowhpMe + "px";
}
//MAO
if(MAO==1){
  random = Math.floor(Math.random() * 30);
  random+=10;
  random*=power;
nowhpMe-=random;
if (nowhpMe > 0) {
if (random == 0) {
str = "あなたは攻撃をかわした";
} else {
str = "あなたは" + random + "のダメージを与えられた";
}
} else {
nowhpMe = 0;
str = "あなたはは力尽きた";
if(nowhpE<=0)str="あなたの死と共に...";
B1.style.display = "none";
B2.style.display = "block";
}
T2.value=str;
NMe.innerHTML = nowhpMe + "/" + maxhpMe;
NMe.style.width = 200 / maxhpMe * nowhpMe + "px";
}
power=1;


count=1;
}

//★ためる
function tameru(){
  power+=1;
  T.value ="あなたは力をためた！";
  if(MAO==1){
  T2.value="魔王「ならば私もそうさせていただこう」";
  }
}

// ★リロード
function reload() {
T.value = "新たな太田ジョンソンを見つけた";
T2.value = "あなたは太田ジョンソンに見つけられた";
if(nowhpE<=0){
  level=localStorage.getItem('mylevel');
  level++; 
  localStorage.setItem('mylevel',level);
  document.getElementById("level").innerHTML = "レベル"+level;
}
//HP回復
maxhpE = Math.floor(Math.random() * 100)+100+(level*5);
nowhpE = maxhpE;
maxhpMe=100+(level*10);
nowhpMe =maxhpMe;
//死体数カウント
mydataOld = localStorage.getItem('mydata');
mydata=parseInt(mydataOld);
mydata +=1;
localStorage.setItem('mydata', mydata);
document.getElementById("mydata_out").innerHTML ="合計" + mydata + "人が死亡";
//魔王出現フラグ
if(MAO==1){
MAO=0;
}else if(level>=30&&maxhpE>180){
T.value = "魔王を見つけた";
T2.value = "あなたは恐怖し、慄く";
maxhpE = 1000
nowhpE = maxhpE;
MAO=1;
}
//その他フラグ、表示回復
B1.style.display = "block";
B2.style.display = "none";
N.innerHTML = nowhpE + "/" + maxhpE;
N.style.width = 200 / maxhpE * nowhpE + "px";
NMe.innerHTML = nowhpMe + "/" + maxhpMe;
NMe.style.width = 200 / maxhpMe * nowhpMe + "px";
enemyname="太田ジョンソン";
if(MAO==1)enemyname="魔王";
nameE.innerHTML=enemyname;
}

//★死体数初期化
function save() {
mydata=0;
localStorage.setItem('mydata', mydata);
document.getElementById("mydata_out").innerHTML ="合計" + mydata + "人が死亡";
}

</script>
</head>

<body onload="load()">
  <div id="nameE"></div>
  <div id="maxEnemy">
    <div id="nowEnemy">
    </div>
  </div>
  <br>
<div id="yourname"></div>
<div id="level"></div>
  <div id="maxMe">
    <div id="nowMe">    
    </div>
  </div>
  <br>
  <input id="btn1" type="button" onclick="attack()" value="斬撃">
  <input id="btn2" type="button" onclick="reload()" value="葬る">
  <input id="btn3" type="button" onclick="tameru()" value="ためる">
  <input id="txt" type="text" value="太田ジョンソンを見つけた">
  <input id="txt2" type="text" value="あなたは太田ジョンソンに見つけられた">
  <div id="mydata_out"></div>
  <input type="button" value="死体数初期化" onclick="save();"/>
</body>
